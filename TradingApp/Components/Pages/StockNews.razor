@page "/news"
@using TradingApp.Data
@inject NewsService NewsService

<div class="news-container">
    <div class="header-section">
        <h1>Market News</h1>
        <p class="lead">Stay informed with the latest market updates and financial news</p>
    </div>

    @if (articles == null)
    {
        <div class="loading-container">
            <div class="spinner-border text-light" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>
    }
    else if (!articles.Any())
    {
        <div class="alert alert-custom">
            <i class="bi bi-exclamation-circle me-2"></i>
            No news articles available at the moment. Please try again later.
        </div>
    }
    else
    {
        <div class="news-grid">
            @foreach (var article in articles)
            {
                <div class="news-item">
                    <NewsCard 
                        Title="@article.Title"
                        Description="@article.Description"
                        Url="@article.Url"
                        Source="@article.Source"
                        PublishedAt="@article.PublishedAt" />
                </div>
            }
        </div>
    }
</div>

@code {
    private List<NewsArticle>? articles;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            articles = await NewsService.GetMarketNewsAsync();
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error in StockNews: {ex.Message}");
            articles = new List<NewsArticle>();
        }
    }
}